include ../inc/head.pug

div.content
    div.container
        div.container-8
            div.box
                h4 Modifier le profil
                form(method='post', enctype='multipart/form-data')
                    
                    div.row
                        div.container-2.center
                            label Avatar
                            
                            label(for='avatar')
                                img(src='/assets/img/avatars/' + userData.avatar).avatar.profile
                            p.light PNG, JPG, GIF
                            input(type='file', id='avatar', name='avatar', onchange="preview(this);")
                                
                        div.container-1
                        
                        div.container-9
                            label Nom
                            input(type='text', name='name', value=userData.name, required)
                            
                            label Adresse e-mail
                            input(type='email', name='email', value=userData.email, required)
                    
                    if user.role == 'admin'
                        label Rôle
                        select(name='role', value=userData.role)
                            each role in roles
                                if role == userData.role
                                    option(value=role, selected) #{role}
                                else
                                    option(value=role) #{role}
                                
                    label Bio
                    textarea(name='bio').tinyedit !{userData.bio}
                        
                    button(type='submit').btn Modifier le profil
        
        div.container-4
            div.box
                h4 Activité
                p Aucune activité
                    
    div.container
        div.container-6
            div.box
                h4 Questions (#{userData.Questions.length})
                hr
                each question in userData.Questions
                    p
                        a(href='/q/' + question.id + '-' + question.urlname, target='_blank') #{question.title}
                        if question.resolvedAt
                            span.force-right.badge.success Résolue
                        else
                            span.force-right.badge.error Non résolue
                else
                    p Aucune question publiée. 
                        a(href='/q/publish') Publiez-en une maintenant
                        | .
                    
        div.container-6
            div.box
                h4 Réponses (#{userData.Comments.length})
                hr
                each comment in userData.Comments
                    p ##{comment.id} postée #{moment(comment.createdAt).fromNow()} dans 
                        a(href='/q/' + comment.QuestionId + '-' + comment.Question.urlname, target='_blank') #{comment.Question.title}
                else
                    p Aucune réponse publiée.

include ../inc/foot.pug
script(src='/assets/js/account/profile.js')
